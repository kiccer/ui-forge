import{E as S}from"./index-BUHSIIsJ.js";import{h as ae,j as v,aL as he,k as $,aA as ke,c as p,C as pe,w as M,n as I,K as le,p as re,s as ne,ak as P,v as Ce,x as V,y as w,U,H as E,N as T,R as me,S as O,u as e,Y as q,A as y,O as W,b6 as ge,T as H,at as Q,ay as Y,I as ye,a3 as be,z as G,_ as se,r as J,B as ve,ag as X,a9 as Z,aG as Ee,al as x,ai as Te,W as _e}from"./index-CQXB1C3t.js";import{C as oe,U as ce}from"./event-BB_Ol6Sd.js";import{ElCheckbox as ee,ElCheckboxGroup as Ve}from"./index-Bb_-glpb.js";import{E as Ae}from"./index-DQ_kKzU_.js";import{u as de}from"./index-C-6OfDDU.js";import{c as De}from"./index-4das4cVd.js";import"./index--KdNXts2.js";import"./isEqual-BfqlHFGY.js";import"./hasIn-DLUfdMxn.js";import"./flatten-DW-kOPV4.js";import"./_baseFlatten-DXKqdjAq.js";import"./_overRest-COy1ctVY.js";import"./identity-DKeuBCMA.js";import"./index-BgPp_mYL.js";const ie="left-check-change",ue="right-check-change",B=ae({data:{type:v(Array),default:()=>[]},titles:{type:v(Array),default:()=>[]},buttonTexts:{type:v(Array),default:()=>[]},filterPlaceholder:String,filterMethod:{type:v(Function)},leftDefaultChecked:{type:v(Array),default:()=>[]},rightDefaultChecked:{type:v(Array),default:()=>[]},renderContent:{type:v(Function)},modelValue:{type:v(Array),default:()=>[]},format:{type:v(Object),default:()=>({})},filterable:Boolean,props:{type:v(Object),default:()=>he({label:"label",key:"key",disabled:"disabled"})},targetOrder:{type:String,values:["original","push","unshift"],default:"original"},validateEvent:{type:Boolean,default:!0}}),K=(t,a)=>[t,a].every($)||$(t)&&ke(a),Pe={[oe]:(t,a,k)=>[t,k].every($)&&["left","right"].includes(a),[ce]:t=>$(t),[ie]:K,[ue]:K},j="checked-change",Ne=ae({data:B.data,optionRender:{type:v(Function)},placeholder:String,title:String,filterable:Boolean,format:B.format,filterMethod:B.filterMethod,defaultChecked:B.leftDefaultChecked,props:B.props}),Be={[j]:K},F=t=>{const a={label:"label",key:"key",disabled:"disabled"};return p(()=>({...a,...t.props}))},we=(t,a,k)=>{const n=F(t),i=p(()=>t.data.filter(l=>pe(t.filterMethod)?t.filterMethod(a.query,l):String(l[n.value.label]||l[n.value.key]).toLowerCase().includes(a.query.toLowerCase()))),s=p(()=>i.value.filter(l=>!l[n.value.disabled])),f=p(()=>{const l=a.checked.length,c=t.data.length,{noChecked:h,hasChecked:b}=t.format;return h&&b?l>0?b.replace(/\${checked}/g,l.toString()).replace(/\${total}/g,c.toString()):h.replace(/\${total}/g,c.toString()):`${l}/${c}`}),r=p(()=>{const l=a.checked.length;return l>0&&l<s.value.length}),u=()=>{const l=s.value.map(c=>c[n.value.key]);a.allChecked=l.length>0&&l.every(c=>a.checked.includes(c))},d=l=>{a.checked=l?s.value.map(c=>c[n.value.key]):[]};return M(()=>a.checked,(l,c)=>{if(u(),a.checkChangeByUser){const h=l.concat(c).filter(b=>!l.includes(b)||!c.includes(b));k(j,l,h)}else k(j,l),a.checkChangeByUser=!0}),M(s,()=>{u()}),M(()=>t.data,()=>{const l=[],c=i.value.map(h=>h[n.value.key]);a.checked.forEach(h=>{c.includes(h)&&l.push(h)}),a.checkChangeByUser=!1,a.checked=l}),M(()=>t.defaultChecked,(l,c)=>{if(c&&l.length===c.length&&l.every(m=>c.includes(m)))return;const h=[],b=s.value.map(m=>m[n.value.key]);l.forEach(m=>{b.includes(m)&&h.push(m)}),a.checkChangeByUser=!1,a.checked=h},{immediate:!0}),{filteredData:i,checkableData:s,checkedSummary:f,isIndeterminate:r,updateAllChecked:u,handleAllCheckedChange:d}},Le=(t,a)=>({onSourceCheckedChange:(i,s)=>{t.leftChecked=i,s&&a(ie,i,s)},onTargetCheckedChange:(i,s)=>{t.rightChecked=i,s&&a(ue,i,s)}}),Me=t=>{const a=F(t),k=p(()=>t.data.reduce((s,f)=>(s[f[a.value.key]]=f)&&s,{})),n=p(()=>t.data.filter(s=>!t.modelValue.includes(s[a.value.key]))),i=p(()=>t.targetOrder==="original"?t.data.filter(s=>t.modelValue.includes(s[a.value.key])):t.modelValue.reduce((s,f)=>{const r=k.value[f];return r&&s.push(r),s},[]));return{sourceData:n,targetData:i}},Ue=(t,a,k)=>{const n=F(t),i=(r,u,d)=>{k(ce,r),k(oe,r,u,d)};return{addToLeft:()=>{const r=t.modelValue.slice();a.rightChecked.forEach(u=>{const d=r.indexOf(u);d>-1&&r.splice(d,1)}),i(r,"left",a.rightChecked)},addToRight:()=>{let r=t.modelValue.slice();const u=t.data.filter(d=>{const l=d[n.value.key];return a.leftChecked.includes(l)&&!t.modelValue.includes(l)}).map(d=>d[n.value.key]);r=t.targetOrder==="unshift"?u.concat(r):r.concat(u),t.targetOrder==="original"&&(r=t.data.filter(d=>r.includes(d[n.value.key])).map(d=>d[n.value.key])),i(r,"right",a.leftChecked)}}},Oe=I({name:"ElTransferPanel"}),Fe=I({...Oe,props:Ne,emits:Be,setup(t,{expose:a,emit:k}){const n=t,i=le(),s=({option:C})=>C,{t:f}=de(),r=re("transfer"),u=ne({checked:[],allChecked:!1,query:"",checkChangeByUser:!0}),d=F(n),{filteredData:l,checkedSummary:c,isIndeterminate:h,handleAllCheckedChange:b}=we(n,u,k),m=p(()=>!P(u.query)&&P(l.value)),R=p(()=>!P(i.default()[0].children)),{checked:A,allChecked:D,query:N}=Ce(u);return a({query:N}),(C,_)=>(V(),w("div",{class:y(e(r).b("panel"))},[U("p",{class:y(e(r).be("panel","header"))},[E(e(ee),{modelValue:e(D),"onUpdate:modelValue":_[0]||(_[0]=g=>q(D)?D.value=g:null),indeterminate:e(h),"validate-event":!1,onChange:e(b)},{default:T(()=>[me(O(C.title)+" ",1),U("span",null,O(e(c)),1)]),_:1},8,["modelValue","indeterminate","onChange"])],2),U("div",{class:y([e(r).be("panel","body"),e(r).is("with-footer",e(R))])},[C.filterable?(V(),W(e(Ae),{key:0,modelValue:e(N),"onUpdate:modelValue":_[1]||(_[1]=g=>q(N)?N.value=g:null),class:y(e(r).be("panel","filter")),size:"default",placeholder:C.placeholder,"prefix-icon":e(ge),clearable:"","validate-event":!1},null,8,["modelValue","class","placeholder","prefix-icon"])):H("v-if",!0),Q(E(e(Ve),{modelValue:e(A),"onUpdate:modelValue":_[2]||(_[2]=g=>q(A)?A.value=g:null),"validate-event":!1,class:y([e(r).is("filterable",C.filterable),e(r).be("panel","list")])},{default:T(()=>[(V(!0),w(ye,null,be(e(l),g=>(V(),W(e(ee),{key:g[e(d).key],class:y(e(r).be("panel","item")),value:g[e(d).key],disabled:g[e(d).disabled],"validate-event":!1},{default:T(()=>{var L;return[E(s,{option:(L=C.optionRender)==null?void 0:L.call(C,g)},null,8,["option"])]}),_:2},1032,["class","value","disabled"]))),128))]),_:1},8,["modelValue","class"]),[[Y,!e(m)&&!e(P)(C.data)]]),Q(U("p",{class:y(e(r).be("panel","empty"))},O(e(m)?e(f)("el.transfer.noMatch"):e(f)("el.transfer.noData")),3),[[Y,e(m)||e(P)(C.data)]])],2),e(R)?(V(),w("p",{key:0,class:y(e(r).be("panel","footer"))},[G(C.$slots,"default")],2)):H("v-if",!0)],2))}});var te=se(Fe,[["__file","transfer-panel.vue"]]);const Re={key:0},$e={key:0},He=I({name:"ElTransfer"}),Ie=I({...He,props:B,emits:Pe,setup(t,{expose:a,emit:k}){const n=t,i=le(),{t:s}=de(),f=re("transfer"),{formItem:r}=De(),u=ne({leftChecked:[],rightChecked:[]}),d=F(n),{sourceData:l,targetData:c}=Me(n),{onSourceCheckedChange:h,onTargetCheckedChange:b}=Le(u,k),{addToLeft:m,addToRight:R}=Ue(n,u,k),A=J(),D=J(),N=o=>{switch(o){case"left":A.value.query="";break;case"right":D.value.query="";break}},C=p(()=>n.buttonTexts.length===2),_=p(()=>n.titles[0]||s("el.transfer.titles.0")),g=p(()=>n.titles[1]||s("el.transfer.titles.1")),L=p(()=>n.filterPlaceholder||s("el.transfer.filterPlaceholder"));M(()=>n.modelValue,()=>{var o;n.validateEvent&&((o=r==null?void 0:r.validate)==null||o.call(r,"change").catch(fe=>ve()))});const z=p(()=>o=>n.renderContent?n.renderContent(X,o):i.default?i.default({option:o}):X("span",o[d.value.label]||o[d.value.key]));return a({clearQuery:N,leftPanel:A,rightPanel:D}),(o,fe)=>(V(),w("div",{class:y(e(f).b())},[E(te,{ref_key:"leftPanel",ref:A,data:e(l),"option-render":e(z),placeholder:e(L),title:e(_),filterable:o.filterable,format:o.format,"filter-method":o.filterMethod,"default-checked":o.leftDefaultChecked,props:n.props,onCheckedChange:e(h)},{default:T(()=>[G(o.$slots,"left-footer")]),_:3},8,["data","option-render","placeholder","title","filterable","format","filter-method","default-checked","props","onCheckedChange"]),U("div",{class:y(e(f).e("buttons"))},[E(e(S),{type:"primary",class:y([e(f).e("button"),e(f).is("with-texts",e(C))]),disabled:e(P)(u.rightChecked),onClick:e(m)},{default:T(()=>[E(e(Z),null,{default:T(()=>[E(e(Ee))]),_:1}),e(x)(o.buttonTexts[0])?H("v-if",!0):(V(),w("span",Re,O(o.buttonTexts[0]),1))]),_:1},8,["class","disabled","onClick"]),E(e(S),{type:"primary",class:y([e(f).e("button"),e(f).is("with-texts",e(C))]),disabled:e(P)(u.leftChecked),onClick:e(R)},{default:T(()=>[e(x)(o.buttonTexts[1])?H("v-if",!0):(V(),w("span",$e,O(o.buttonTexts[1]),1)),E(e(Z),null,{default:T(()=>[E(e(Te))]),_:1})]),_:1},8,["class","disabled","onClick"])],2),E(te,{ref_key:"rightPanel",ref:D,data:e(c),"option-render":e(z),placeholder:e(L),filterable:o.filterable,format:o.format,"filter-method":o.filterMethod,title:e(g),"default-checked":o.rightDefaultChecked,props:n.props,onCheckedChange:e(b)},{default:T(()=>[G(o.$slots,"right-footer")]),_:3},8,["data","option-render","placeholder","filterable","format","filter-method","title","default-checked","props","onCheckedChange"])],2))}});var qe=se(Ie,[["__file","transfer.vue"]]);const lt=_e(qe);export{lt as ElTransfer,ie as LEFT_CHECK_CHANGE_EVENT,ue as RIGHT_CHECK_CHANGE_EVENT,lt as default,K as transferCheckedChangeFn,Pe as transferEmits,B as transferProps};
