import{E as Q}from"./index-EO3daBrL.js";import{A as ae,C as v,b6 as he,D as R,aX as ke,l as C,R as Ce,w as M,G,a0 as le,aF as re,H as ne,J as se,aG as P,K as pe,N as V,O as w,ab as F,Y as E,a4 as T,a8 as me,a9 as O,s as e,af as I,Q as y,a5 as J,bz as ge,aa as $,aQ as S,aV as W,Z as ye,ao as be,P as q,_ as oe,n as X,T as ve,aB as Y,aw as Z,b1 as Ee,aH as x,aD as Te,ad as _e}from"./index-CL6XICGL.js";import{C as ce,U as de}from"./event-BB_Ol6Sd.js";import{ElCheckbox as ee,ElCheckboxGroup as Ve}from"./index-C3-dp3_h.js";import{E as De}from"./index-LfVN8sNI.js";import{a as Ae}from"./index-hzQ4Cvu1.js";import"./index-DmXysdXv.js";import"./isEqual-C1ieMyBP.js";import"./hasIn-DRkKcHp0.js";import"./flatten-BxGsWawP.js";import"./_baseFlatten--8eNCVlQ.js";import"./_overRest-Cb9oY3tT.js";import"./identity-DKeuBCMA.js";import"./index-CaizXh6A.js";const ie="left-check-change",ue="right-check-change",B=ae({data:{type:v(Array),default:()=>[]},titles:{type:v(Array),default:()=>[]},buttonTexts:{type:v(Array),default:()=>[]},filterPlaceholder:String,filterMethod:{type:v(Function)},leftDefaultChecked:{type:v(Array),default:()=>[]},rightDefaultChecked:{type:v(Array),default:()=>[]},renderContent:{type:v(Function)},modelValue:{type:v(Array),default:()=>[]},format:{type:v(Object),default:()=>({})},filterable:Boolean,props:{type:v(Object),default:()=>he({label:"label",key:"key",disabled:"disabled"})},targetOrder:{type:String,values:["original","push","unshift"],default:"original"},validateEvent:{type:Boolean,default:!0}}),K=(t,a)=>[t,a].every(R)||R(t)&&ke(a),Pe={[ce]:(t,a,k)=>[t,k].every(R)&&["left","right"].includes(a),[de]:t=>R(t),[ie]:K,[ue]:K},j="checked-change",Ne=ae({data:B.data,optionRender:{type:v(Function)},placeholder:String,title:String,filterable:Boolean,format:B.format,filterMethod:B.filterMethod,defaultChecked:B.leftDefaultChecked,props:B.props}),Be={[j]:K},U=t=>{const a={label:"label",key:"key",disabled:"disabled"};return C(()=>({...a,...t.props}))},we=(t,a,k)=>{const n=U(t),i=C(()=>t.data.filter(l=>Ce(t.filterMethod)?t.filterMethod(a.query,l):String(l[n.value.label]||l[n.value.key]).toLowerCase().includes(a.query.toLowerCase()))),s=C(()=>i.value.filter(l=>!l[n.value.disabled])),f=C(()=>{const l=a.checked.length,c=t.data.length,{noChecked:h,hasChecked:b}=t.format;return h&&b?l>0?b.replace(/\${checked}/g,l.toString()).replace(/\${total}/g,c.toString()):h.replace(/\${total}/g,c.toString()):`${l}/${c}`}),r=C(()=>{const l=a.checked.length;return l>0&&l<s.value.length}),u=()=>{const l=s.value.map(c=>c[n.value.key]);a.allChecked=l.length>0&&l.every(c=>a.checked.includes(c))},d=l=>{a.checked=l?s.value.map(c=>c[n.value.key]):[]};return M(()=>a.checked,(l,c)=>{if(u(),a.checkChangeByUser){const h=l.concat(c).filter(b=>!l.includes(b)||!c.includes(b));k(j,l,h)}else k(j,l),a.checkChangeByUser=!0}),M(s,()=>{u()}),M(()=>t.data,()=>{const l=[],c=i.value.map(h=>h[n.value.key]);a.checked.forEach(h=>{c.includes(h)&&l.push(h)}),a.checkChangeByUser=!1,a.checked=l}),M(()=>t.defaultChecked,(l,c)=>{if(c&&l.length===c.length&&l.every(m=>c.includes(m)))return;const h=[],b=s.value.map(m=>m[n.value.key]);l.forEach(m=>{b.includes(m)&&h.push(m)}),a.checkChangeByUser=!1,a.checked=h},{immediate:!0}),{filteredData:i,checkableData:s,checkedSummary:f,isIndeterminate:r,updateAllChecked:u,handleAllCheckedChange:d}},Le=(t,a)=>({onSourceCheckedChange:(i,s)=>{t.leftChecked=i,s&&a(ie,i,s)},onTargetCheckedChange:(i,s)=>{t.rightChecked=i,s&&a(ue,i,s)}}),Me=t=>{const a=U(t),k=C(()=>t.data.reduce((s,f)=>(s[f[a.value.key]]=f)&&s,{})),n=C(()=>t.data.filter(s=>!t.modelValue.includes(s[a.value.key]))),i=C(()=>t.targetOrder==="original"?t.data.filter(s=>t.modelValue.includes(s[a.value.key])):t.modelValue.reduce((s,f)=>{const r=k.value[f];return r&&s.push(r),s},[]));return{sourceData:n,targetData:i}},Fe=(t,a,k)=>{const n=U(t),i=(r,u,d)=>{k(de,r),k(ce,r,u,d)};return{addToLeft:()=>{const r=t.modelValue.slice();a.rightChecked.forEach(u=>{const d=r.indexOf(u);d>-1&&r.splice(d,1)}),i(r,"left",a.rightChecked)},addToRight:()=>{let r=t.modelValue.slice();const u=t.data.filter(d=>{const l=d[n.value.key];return a.leftChecked.includes(l)&&!t.modelValue.includes(l)}).map(d=>d[n.value.key]);r=t.targetOrder==="unshift"?u.concat(r):r.concat(u),t.targetOrder==="original"&&(r=t.data.filter(d=>r.includes(d[n.value.key])).map(d=>d[n.value.key])),i(r,"right",a.leftChecked)}}},Oe=G({name:"ElTransferPanel"}),Ue=G({...Oe,props:Ne,emits:Be,setup(t,{expose:a,emit:k}){const n=t,i=le(),s=({option:p})=>p,{t:f}=re(),r=ne("transfer"),u=se({checked:[],allChecked:!1,query:"",checkChangeByUser:!0}),d=U(n),{filteredData:l,checkedSummary:c,isIndeterminate:h,handleAllCheckedChange:b}=we(n,u,k),m=C(()=>!P(u.query)&&P(l.value)),H=C(()=>!P(i.default()[0].children)),{checked:D,allChecked:A,query:N}=pe(u);return a({query:N}),(p,_)=>(V(),w("div",{class:y(e(r).b("panel"))},[F("p",{class:y(e(r).be("panel","header"))},[E(e(ee),{modelValue:e(A),"onUpdate:modelValue":_[0]||(_[0]=g=>I(A)?A.value=g:null),indeterminate:e(h),"validate-event":!1,onChange:e(b)},{default:T(()=>[me(O(p.title)+" ",1),F("span",null,O(e(c)),1)]),_:1},8,["modelValue","indeterminate","onChange"])],2),F("div",{class:y([e(r).be("panel","body"),e(r).is("with-footer",e(H))])},[p.filterable?(V(),J(e(De),{key:0,modelValue:e(N),"onUpdate:modelValue":_[1]||(_[1]=g=>I(N)?N.value=g:null),class:y(e(r).be("panel","filter")),size:"default",placeholder:p.placeholder,"prefix-icon":e(ge),clearable:"","validate-event":!1},null,8,["modelValue","class","placeholder","prefix-icon"])):$("v-if",!0),S(E(e(Ve),{modelValue:e(D),"onUpdate:modelValue":_[2]||(_[2]=g=>I(D)?D.value=g:null),"validate-event":!1,class:y([e(r).is("filterable",p.filterable),e(r).be("panel","list")])},{default:T(()=>[(V(!0),w(ye,null,be(e(l),g=>(V(),J(e(ee),{key:g[e(d).key],class:y(e(r).be("panel","item")),value:g[e(d).key],disabled:g[e(d).disabled],"validate-event":!1},{default:T(()=>{var L;return[E(s,{option:(L=p.optionRender)==null?void 0:L.call(p,g)},null,8,["option"])]}),_:2},1032,["class","value","disabled"]))),128))]),_:1},8,["modelValue","class"]),[[W,!e(m)&&!e(P)(p.data)]]),S(F("p",{class:y(e(r).be("panel","empty"))},O(e(m)?e(f)("el.transfer.noMatch"):e(f)("el.transfer.noData")),3),[[W,e(m)||e(P)(p.data)]])],2),e(H)?(V(),w("p",{key:0,class:y(e(r).be("panel","footer"))},[q(p.$slots,"default")],2)):$("v-if",!0)],2))}});var te=oe(Ue,[["__file","transfer-panel.vue"]]);const He={key:0},Re={key:0},$e=G({name:"ElTransfer"}),Ge=G({...$e,props:B,emits:Pe,setup(t,{expose:a,emit:k}){const n=t,i=le(),{t:s}=re(),f=ne("transfer"),{formItem:r}=Ae(),u=se({leftChecked:[],rightChecked:[]}),d=U(n),{sourceData:l,targetData:c}=Me(n),{onSourceCheckedChange:h,onTargetCheckedChange:b}=Le(u,k),{addToLeft:m,addToRight:H}=Fe(n,u,k),D=X(),A=X(),N=o=>{switch(o){case"left":D.value.query="";break;case"right":A.value.query="";break}},p=C(()=>n.buttonTexts.length===2),_=C(()=>n.titles[0]||s("el.transfer.titles.0")),g=C(()=>n.titles[1]||s("el.transfer.titles.1")),L=C(()=>n.filterPlaceholder||s("el.transfer.filterPlaceholder"));M(()=>n.modelValue,()=>{var o;n.validateEvent&&((o=r==null?void 0:r.validate)==null||o.call(r,"change").catch(fe=>ve()))});const z=C(()=>o=>n.renderContent?n.renderContent(Y,o):i.default?i.default({option:o}):Y("span",o[d.value.label]||o[d.value.key]));return a({clearQuery:N,leftPanel:D,rightPanel:A}),(o,fe)=>(V(),w("div",{class:y(e(f).b())},[E(te,{ref_key:"leftPanel",ref:D,data:e(l),"option-render":e(z),placeholder:e(L),title:e(_),filterable:o.filterable,format:o.format,"filter-method":o.filterMethod,"default-checked":o.leftDefaultChecked,props:n.props,onCheckedChange:e(h)},{default:T(()=>[q(o.$slots,"left-footer")]),_:3},8,["data","option-render","placeholder","title","filterable","format","filter-method","default-checked","props","onCheckedChange"]),F("div",{class:y(e(f).e("buttons"))},[E(e(Q),{type:"primary",class:y([e(f).e("button"),e(f).is("with-texts",e(p))]),disabled:e(P)(u.rightChecked),onClick:e(m)},{default:T(()=>[E(e(Z),null,{default:T(()=>[E(e(Ee))]),_:1}),e(x)(o.buttonTexts[0])?$("v-if",!0):(V(),w("span",He,O(o.buttonTexts[0]),1))]),_:1},8,["class","disabled","onClick"]),E(e(Q),{type:"primary",class:y([e(f).e("button"),e(f).is("with-texts",e(p))]),disabled:e(P)(u.leftChecked),onClick:e(H)},{default:T(()=>[e(x)(o.buttonTexts[1])?$("v-if",!0):(V(),w("span",Re,O(o.buttonTexts[1]),1)),E(e(Z),null,{default:T(()=>[E(e(Te))]),_:1})]),_:1},8,["class","disabled","onClick"])],2),E(te,{ref_key:"rightPanel",ref:A,data:e(c),"option-render":e(z),placeholder:e(L),filterable:o.filterable,format:o.format,"filter-method":o.filterMethod,title:e(g),"default-checked":o.rightDefaultChecked,props:n.props,onCheckedChange:e(b)},{default:T(()=>[q(o.$slots,"right-footer")]),_:3},8,["data","option-render","placeholder","filterable","format","filter-method","title","default-checked","props","onCheckedChange"])],2))}});var Ie=oe(Ge,[["__file","transfer.vue"]]);const at=_e(Ie);export{at as ElTransfer,ie as LEFT_CHECK_CHANGE_EVENT,ue as RIGHT_CHECK_CHANGE_EVENT,at as default,K as transferCheckedChangeFn,Pe as transferEmits,B as transferProps};
